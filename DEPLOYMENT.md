# å…«å­—å…³ç³»äº’åŠ¨æ¸¸æˆ - éƒ¨ç½²æŒ‡å—

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªäº’åŠ¨çš„å…«å­—å…³ç³»æ¸¸æˆï¼Œç”¨æˆ·å¯ä»¥ç‚¹å‡»å…«å­—å­—ç¬¦æ‰¾å‡ºå…¶ä¸­çš„å…³ç³»ï¼ˆå¤©å¹²ç›¸åˆç›¸å†²ï¼Œåœ°æ”¯å…­åˆä¸‰åˆç­‰ï¼‰ã€‚

## ğŸš€ æœ¬åœ°å¼€å‘

### é¢„å¤‡æ¡ä»¶
- Python 3.8+ 
- è™šæ‹Ÿç¯å¢ƒï¼ˆæ¨èï¼‰

### æœ¬åœ°å¯åŠ¨æ­¥éª¤

1. **å…‹éš†é¡¹ç›®å¹¶è¿›å…¥ç›®å½•**
```bash
cd bazi2
```

2. **æ¿€æ´»è™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£…ä¾èµ–**
```bash
source venv/bin/activate
pip install -r requirements.txt flask flask-cors
```

3. **è¿è¡Œæœ¬åœ°æµ‹è¯•**
```bash
python test_local.py
```

4. **å¯åŠ¨æœ¬åœ°å¼€å‘æœåŠ¡å™¨**
```bash
python app.py
```

5. **è®¿é—®æ¸¸æˆ**
æ‰“å¼€æµè§ˆå™¨è®¿é—®: `http://localhost:5000`

## â˜ï¸ Netlify éƒ¨ç½²

### æ–‡ä»¶ç»“æ„
```
bazi2/
â”œâ”€â”€ index.html              # å‰ç«¯æ¸¸æˆé¡µé¢
â”œâ”€â”€ netlify.toml            # Netlify é…ç½®
â”œâ”€â”€ requirements.txt        # Python ä¾èµ–
â”œâ”€â”€ runtime.txt             # Python ç‰ˆæœ¬
â”œâ”€â”€ app.py                 # æœ¬åœ° Flask æœåŠ¡å™¨
â”œâ”€â”€ netlify/
â”‚   â””â”€â”€ functions/         # Netlify æ— æœåŠ¡å™¨å‡½æ•°
â”‚       â”œâ”€â”€ new_game.py    # æ–°æ¸¸æˆ API
â”‚       â”œâ”€â”€ check_relationship.py  # æ£€æŸ¥å…³ç³» API
â”‚       â”œâ”€â”€ bazi_utils.py  # å·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ ganzhi.py      # å¹²æ”¯æ•°æ®
â”‚       â”œâ”€â”€ datas.py       # åŸºç¡€æ•°æ®
â”‚       â””â”€â”€ common.py      # é€šç”¨å‡½æ•°
â””â”€â”€ test_local.py          # æœ¬åœ°æµ‹è¯•è„šæœ¬
```

### Netlify éƒ¨ç½²æ­¥éª¤

1. **è¿æ¥ GitHub ä»“åº“**
   - ç™»å½• Netlify
   - ç‚¹å‡» "New site from Git"
   - é€‰æ‹©ä½ çš„ GitHub ä»“åº“

2. **æ„å»ºè®¾ç½®**
   - Build command: (ç•™ç©º)
   - Publish directory: `.` (å½“å‰ç›®å½•)
   - Functions directory: `netlify/functions`

3. **ç¯å¢ƒå˜é‡** (å¯é€‰)
   - `PYTHON_VERSION`: `3.8`

4. **æ‰‹åŠ¨éƒ¨ç½²**
   ä¹Ÿå¯ä»¥ç›´æ¥æ‹–æ‹½é¡¹ç›®æ–‡ä»¶å¤¹åˆ° Netlify è¿›è¡Œéƒ¨ç½²

### éƒ¨ç½²é…ç½®æ–‡ä»¶

#### netlify.toml
```toml
[build]
  publish = "."

[functions]
  directory = "netlify/functions"

[[redirects]]
  from = "/api/*"
  to = "/.netlify/functions/:splat"
  status = 200
```

#### requirements.txt
```
lunar-python==1.4.4
bidict==0.22.1
```

Note: Netlify will automatically detect the Python version needed based on your functions.

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **Netlify æ„å»ºå¤±è´¥ - ä¾èµ–å®‰è£…é”™è¯¯**
   - æ£€æŸ¥ `requirements.txt` ä¸­çš„ç‰ˆæœ¬å·æ˜¯å¦æ­£ç¡®
   - ç¡®ä¿ `lunar-python` ä½¿ç”¨å…¼å®¹ç‰ˆæœ¬ `1.4.4`
   - æ£€æŸ¥ `runtime.txt` æŒ‡å®šæ­£ç¡®çš„ Python ç‰ˆæœ¬

2. **æœ¬åœ°å¯¼å…¥é”™è¯¯**
   - ç¡®ä¿æ¿€æ´»äº†è™šæ‹Ÿç¯å¢ƒ: `source venv/bin/activate`
   - å®‰è£…æ‰€æœ‰ä¾èµ–: `pip install -r requirements.txt flask flask-cors`

3. **API è°ƒç”¨å¤±è´¥**
   - æœ¬åœ°æµ‹è¯•: æ£€æŸ¥ Flask æœåŠ¡å™¨æ˜¯å¦æ­£å¸¸å¯åŠ¨
   - Netlify: æ£€æŸ¥å‡½æ•°æ—¥å¿—ï¼Œç¡®ä¿æ— æœåŠ¡å™¨å‡½æ•°æ­£å¸¸éƒ¨ç½²

4. **ç‰ˆæœ¬å…¼å®¹æ€§é—®é¢˜**
   - ä½¿ç”¨ `python test_local.py` æ£€æŸ¥æ‰€æœ‰æ¨¡å—æ˜¯å¦æ­£å¸¸å¯¼å…¥
   - ç¡®ä¿æ‰€æœ‰ä¾èµ–ç‰ˆæœ¬å…¼å®¹

### è°ƒè¯•å‘½ä»¤

```bash
# æµ‹è¯•æœ¬åœ°å…¼å®¹æ€§
python test_local.py

# å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨
python app.py

# æ£€æŸ¥è™šæ‹Ÿç¯å¢ƒ
source venv/bin/activate
pip list
```

## ğŸ“‹ åŠŸèƒ½ç‰¹æ€§

- âœ… åœ°æ”¯ç›¸åˆ‘é»˜è®¤å…³é—­
- âœ… æŒä¹…åŒ–è®¾ç½®å­˜å‚¨ (localStorage)
- âœ… æ”¯æŒåŸºç¡€æ¨¡å¼ (4æŸ±) å’Œé«˜çº§æ¨¡å¼ (6æŸ±)
- âœ… å®æ—¶å…³ç³»æç¤ºå’Œè¿›åº¦è·Ÿè¸ª
- âœ… å®Œæ•´çš„å…³ç³»ç±»å‹æ”¯æŒ
- âœ… å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒç§»åŠ¨ç«¯

## ğŸ”„ æœ¬åœ°ä¸ Netlify å…¼å®¹æ€§

è¯¥é¡¹ç›®è®¾è®¡ä¸ºåŒæ—¶æ”¯æŒæœ¬åœ°å¼€å‘å’Œ Netlify éƒ¨ç½²ï¼š

- **æœ¬åœ°å¼€å‘**: ä½¿ç”¨ `app.py` Flask æœåŠ¡å™¨
- **Netlify éƒ¨ç½²**: ä½¿ç”¨ `netlify/functions/` æ— æœåŠ¡å™¨å‡½æ•°
- **å…±äº«ä»£ç **: `netlify/functions/` ä¸­çš„å·¥å…·å‡½æ•°å¯ä»¥è¢«ä¸¤ç§ç¯å¢ƒä½¿ç”¨

## ğŸ® æ¸¸æˆè¯´æ˜

1. ç‚¹å‡»2-3ä¸ªå…«å­—å¯»æ‰¾å…³ç³»
2. å¤©å¹²å…³ç³»ï¼šç›¸åˆã€ç›¸å†²
3. åœ°æ”¯å…³ç³»ï¼šå…­åˆã€ç›¸å†²ã€ä¸‰åˆã€ä¸‰ä¼šã€åŠåˆã€åŠä¼šã€ç›¸åˆ‘ã€ç›¸å®³ã€ç›¸ç ´
4. æ‰¾åˆ°å…³ç³»å¯è·å¾—åˆ†æ•°
5. æ‰¾å‡ºæ‰€æœ‰å…³ç³»å®Œæˆæ¸¸æˆ
6. å¯åœ¨è®¾ç½®ä¸­è‡ªå®šä¹‰å¯ç”¨çš„å…³ç³»ç±»å‹